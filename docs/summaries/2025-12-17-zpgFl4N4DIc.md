# The agent development loop with LangSmith + Claude Code / Deepagents

**Channel:** LangChain
**Published:** 2025-12-17
**Video:** [Watch on YouTube](https://youtube.com/watch?v=zpgFl4N4DIc)

---

# 使用 Langsmith-fetch 進行 AI 代理人 (Agent) 的迭代式偵錯

## 重點摘要
本影片介紹了一個名為 `langsmith-fetch` 的新命令列工具，旨在將 LangSmith（一個用於追蹤 LLM 應用的系統）與程式碼代理人（如 Claude Code 或 DevAgent）連接起來。這建立了一個強大的迭代式回饋循環：代理人運行程式碼，其執行過程被記錄到 LangSmith，然後代理人可以抓取並「反思」這些紀錄，以自動偵錯並改進程式碼、提示或工具。

## 故事大綱
- **開場**：講者 Lance 介紹了他部落格文章的核心思想，即在程式碼代理人和 LangSmith 追蹤記錄之間建立一個迭代的回饋循環，並展示了為此目的創建的 `langsmith-fetch` CLI 工具。
- **中段**：影片透過幾個實例展示其工作流程。首先，執行一個簡單的 Python 腳本，並用 `langsmith-fetch` 抓取其執行追蹤。接著，展示如何引導兩個不同的程式碼代理人（Claude Code 和開源的 DevAgent）去執行腳本、透過 `--help` 命令學習 `langsmith-fetch` 的用法，並抓取與總結追蹤內容。其中一個關鍵技巧是為代理人創建「技能 (Skill)」，將 `langsmith-fetch` 的使用方法永久化，使其在未來的對話中能自動使用該工具。
- **結尾**：講者總結，將 LangSmith 作為「記錄系統」與程式碼代理人作為「反思與改進引擎」相結合，是一種非常實用且強大的工作流程。`langsmith-fetch` 這個簡單的工具，為實現對提示、工具和代理人本身的持續優化提供了橋樑。

## 關鍵見解
1.  **回饋循環的力量**：核心概念是「執行 -> 追蹤 -> 抓取 -> 反思 -> 改進」。這是利用 AI 代理人自動化偵錯與優化程式碼的強大模式。
2.  **`langsmith-fetch` 的角色**：它是一個簡單、專為程式碼代理人設計的 CLI 工具，是連接代理人與 LangSmith 追蹤數據的關鍵橋樑。
3.  **代理人「技能」的重要性**：為代理人創建技能（Skills），可以將特定工具（如 `langsmith-fetch`）的使用方法封裝起來，讓代理人能夠「學習」並在未來的工作中重複使用，大幅提升效率。
4.  **追蹤日誌分離**：在使用 DevAgent 的演示中，將代理人自身的內部運作追蹤與它所執行的程式碼追蹤，分別記錄到不同的 LangSmith 專案中，這是一種保持日誌清晰、有條理的最佳實踐。
5.  **通用性與實用性**：這個偵錯工作流程不僅限於特定代理人或場景，它非常通用，可用於迭代改進任何被 LangSmith 追蹤的系統，包括提示、工具或代理人本身的程式碼。

## 精彩時刻
- **展示 `langsmith-fetch` 的簡潔**：僅需 `langsmith-fetch traces` 一個簡單命令，就能輕鬆抓取到最新的執行追蹤。
- **代理人自主學習**：看著程式碼代理人執行 `langsmith-fetch --help`，然後正確地構建出下一步的命令，生動地展示了代理人的自主性。
- **創建「技能」的瞬間**：將工具用法寫入一個 `skill.md` 文件，代理人便立即學會了新技能，這是一個非常實用且令人印象深刻的技巧。
- **區分兩個追蹤專案**：在 DevAgent 演示中，清楚地分開記錄代理人本身和其執行任務的追蹤，揭示了一個微妙但重要的工程實踐。

---

# Iterative Debugging for AI Agents with Langsmith-fetch

## TL;DR
This video introduces `langsmith-fetch`, a new command-line tool designed to connect LangSmith (a system for tracing LLM applications) with code agents like Claude Code or DevAgent. This enables a powerful iterative feedback loop: an agent runs code, the execution is traced to LangSmith, and the agent can then fetch and "reflect" on these traces to automatically debug and improve the code, prompts, or tools.

## Story Flow
- **Beginning**: The speaker, Lance, introduces the core idea from his blog post: creating an iterative feedback loop between a code agent and LangSmith traces. He presents `langsmith-fetch`, the CLI tool he created for this purpose.
- **Middle**: The workflow is demonstrated through practical examples. First, a simple Python script is run, and `langsmith-fetch` is used to grab its execution trace. Next, the video shows how to guide two different code agents (Claude Code and the open-source DevAgent) to execute a script, learn the `langsmith-fetch` CLI via the `--help` command, and then fetch and summarize the trace. A key technique shown is creating a "Skill" for the agent, which teaches it how to use the tool permanently for future sessions.
- **End**: The speaker concludes that combining LangSmith as a "system of record" with code agents as a "reflection and improvement engine" is a highly practical and powerful workflow. The simple `langsmith-fetch` tool serves as the bridge to enable this iterative refinement of prompts, tools, and the agents themselves.

## Key Insights
1.  **The Power of the Feedback Loop**: The core concept is "Execute -> Trace -> Fetch -> Reflect -> Improve." This is a powerful pattern for using AI agents to automate the debugging and optimization of code.
2.  **The Role of `langsmith-fetch`**: It's a simple, crisp CLI designed for code agents to use, acting as the essential bridge between the agent and its LangSmith trace data.
3.  **The Importance of Agent "Skills"**: Creating Skills for agents encapsulates knowledge about how to use a specific tool (like `langsmith-fetch`), allowing the agent to "learn" and reuse that knowledge, which dramatically improves efficiency.
4.  **Separation of Tracing Logs**: As shown with DevAgent, logging the agent's internal operations to a separate LangSmith project from the code it executes is a best practice for keeping logs clean and organized.
5.  **Generality and Practicality**: This debugging workflow is not limited to a specific agent or scenario. It's a general-purpose and highly practical method for iteratively improving any system being traced to LangSmith, including prompts, tools, or the agent's own code.

## Notable Moments
- **The Simplicity of `langsmith-fetch`**: A single, clean command (`langsmith-fetch traces`) easily pulls the latest execution trace.
- **Agent Autonomous Learning**: Watching the code agent run `langsmith-fetch --help` and then correctly construct the next command vividly demonstrates the agent's autonomy.
- **The "Skill" Creation Moment**: Writing tool instructions into a `skill.md` file and seeing the agent instantly learn a new capability is a very practical and impressive trick.
- **Distinguishing Two Trace Projects**: The DevAgent demo clearly separates traces from the agent itself and the task it runs, revealing a subtle but important engineering practice.
